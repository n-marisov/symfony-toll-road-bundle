<?xml version="1.0" encoding="UTF-8"?>
<doctrine-mapping xmlns="http://doctrine-project.org/schemas/orm/doctrine-mapping"
                      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                      xsi:schemaLocation="http://doctrine-project.org/schemas/orm/doctrine-mapping
                          https://www.doctrine-project.org/schemas/orm/doctrine-mapping.xsd">

    <!-- Реализует собой ценовое правило -->
    <entity name="Maris\Symfony\TollRoad\Entity\PriceRule"  table="toll_road_prices" inheritance-type="SINGLE_TABLE" >

        <discriminator-column name="group" length="3" type="string" />

        <discriminator-map>
            <discriminator-mapping value="I" class="Maris\Symfony\TollRoad\Entity\PriceRuleI"/>
            <discriminator-mapping value="II" class="Maris\Symfony\TollRoad\Entity\PriceRuleII"/>
            <discriminator-mapping value="III" class="Maris\Symfony\TollRoad\Entity\PriceRuleIII"/>
            <discriminator-mapping value="VI" class="Maris\Symfony\TollRoad\Entity\PriceRuleVI"/>
        </discriminator-map>

        <discriminator-column name="view"/>

        <id name="id" type="integer" column="id" >
            <generator />
        </id>

        <field name="price" type="decimal" precision="6" scale="2" />


        <many-to-one field="tollRoad" target-entity="Maris\Symfony\TollRoad\Entity\TollRoad" >

            <cascade>
                <cascade-persist />
                <cascade-remove />
            </cascade>

            <join-columns>
                <join-column name="toll_road_id" />
            </join-columns>

        </many-to-one>

    </entity>

</doctrine-mapping>